\section[Linear recurrences]{Linear recurrences - The Fibonacci sequence}\label{fibonacci} 

We are going to discuss the Fibonacci sequence in the following section.

\subsection{Fibonacci's rabbit problem}

Suppose we have a pair of rabbits that are adults after one month. In the month after they are fully grown,
they give birth to two more rabbits. The newborns are again fully grown after one month and give birth to two more 
rabbits, and so on. Consider the following figure as an example.
\\
\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=1$\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=2 \text{ (grown up)}$
\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=3$
\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=4$
\\
\\
\noindent
\textbf{Question:} How many pairs of rabbits will we have after one year?
\\
\\
\noindent
Let us introduce the following notation. Denote the number of pairs of rabbits during
the $n$-th month by $F(n)$. Then, we could express $F(n)$ by the number of rabbits in 
the $(n-1)$-th month and $(n-2)$-th month by the following equation.
$$
F(n)=F(n-1)+F(n-2)
$$
Thus, by setting $F(2)=1$ the following sequence of numbers follows.
$$
1,1,2,3,5,8,13,21,36,55,89,144, \cdots
$$
\noindent
The answer follows for $F(12)=144$, hence after $12$ months we have $144$ pairs of rabbits.
\\
\\
The above sequence is called the "Fibonacci sequence" and we are going to investigate some 
of its fascinating properties in the next sections.

\newpage

\subsection[Pascal triangle]{Fibonacci numbers and the Pascal triangle}

We consider once again the Pascal triangle. Let us sum up its diagonals. This is done in the following figure for 
the first few diagonals.
\\
\\
\begin{tabular}{>{$n=}l<{$\hspace{12pt}}*{13}{c}}
    0 &&&&&&&1&&&&&&\\
    1 &&&&&&1&&\color{red}1\textsuperscript{\color{red}=2}&&&&&\\
    2 &&&&&\color{red}1&&\color{yellow}2\textsuperscript{\color{yellow}=3}&&1&&&&\\
    3 &&&&\color{yellow}1&&\color{green}3\textsuperscript{\color{green}=4}&&\color{blue}3\textsuperscript{\color{blue}=8}&&\color{cyan}1\textsuperscript{\color{cyan}=13}&&&\\
    4 &&&\color{green}1&&\color{blue}4&&\color{cyan}6&&4&&1&&\\
    5 &&\color{blue}1&&\color{cyan}5&&10&&10&&5&&1&\\
    6 &\color{cyan}1&&6&&15&&20&&15&&6&&1
\end{tabular}
\\
\\
\noindent
The following sequence is the result.
$$
1,1,
\color{red} 1 \color{black}+ \color{red}1\color{black}=\color{red}2 \color{black}, \color{yellow} 1 \color{black}+ \color{yellow}2\color{black}=\color{yellow}3 \color{black}, 
\color{green} 1 \color{black}+ \color{green}3\color{black}=\color{green}4 \color{black}, 
\color{blue} 1 \color{black}+ \color{blue}4\color{black}+ \color{blue}3=\color{blue}8 \color{black}, 
\color{cyan} 1 \color{black}+ \color{cyan}5\color{black}+ \color{cyan}6\color{black}+ \color{cyan}1=\color{cyan}13 \color{black}, \cdots 
$$
The general formula for the sum of the diagonals in the Pascal triangle is easily derived. It is as follows.
$$
\sum_{k=0}^{\floor{\frac{n-1}{2}}} {n-k-1 \choose k}
$$

\subsection{Domino tilings}

\subsection{Linear recurrence relations}

In the following section, we are going to introduce the formal definition of a linear recurrence relation.

\begin{defn}
A linear recurrence relation of order $k$ is a sequence satisfying 
$$
A(n)=c_1A(n-1)+c_2A(n-2)+\cdots+c_kA(n-k)
$$
where $c_1,\cdots, c_k \in \mathbb{R}$.
\label{defn:rec}
\end{defn}

\begin{exmp}
The Fibonacci sequence $F(n)=F(n-1)+F(n-2)$ is a linear recurrence relation of order $2$. The sequence
$A(n)=A(n-1)+A(n-2)+A(n-5)$ from the last section is a linear recurrence relation of order $5$.
\end{exmp}

\begin{remark}
A sequence defined by a linear recurrence relation is uniquely determined by the first $k$ terms $A(0), A(1), \cdots, A(k-1)$.
Why is that the case? Suppose that $a_0, a_1, a_2, \cdots$ and $a_0', a_1', a_2', \cdots$ satisfy the relation $(*)$,
then $a_0+a_0', a_1+a_1',a_2+a_2', \cdots$ also satisfy $(*)$ and so does $c \cdots a_0, c \cdot a_1, c \cdot a_2, \cdots$.
In other words, the solutions of a linear recurrence relation form a vector space.
\end{remark}

\subsection[The characteristic equation]{The characteristic equation}

In the following section we want to solve the following problem.\\
\textbf{Problem:} Given a recurrence relation
$$
(*)\ A(n)=c_1A(n-1)+c_2A(n-2)+\cdots+c_kA(n-k)
$$
as in definition \ref{defn:rec}. Find \underline{all} the sequences $(a_0, a_1, a_2, \cdots)$ satisfying this relation.
\\
For $k=1$ the linear recurrence relation yields $A(n)=c \cdot A(n-1)$, and the answer for our problem is just the geometric progression 
given by $a_n=c^n a_0$ where $a_0 \in \mathbb{R}$.
\\
\\
\noindent
\textbf{Idea:} Find a geometric progression $(a_0, \lambda a_0, \lambda^2 a_0, \cdots)$ satisfying $(*)$. Suppose $\lambda \neq 0$ and $a_0 \neq 0$.
Then,
$$
a_0 \lambda^n=c_1 a_0 \lambda^{n-1}+c_2 a_0 \lambda^{n-2} + \cdots + c_k a_0 \lambda^{n-k}, \forall n \geq k.
$$
Dividing the above equation by $a_0 \lambda^{n-k}$ yields 
$$
\lambda^k=c_1 \lambda^{k-1} + c_2 \lambda^{k-2} + \cdots + c_k.
$$
Then $\lambda$ is a root of the so called \underline{characteristic equation} which is given by
$$
t^k=c_1t^{k-1}+c_2 t^{k-2} + \cdots + c_k.
$$
The coefficients of the characteristic equation are the same as in the original recurrence relation.

\subsection{Linear recurrence relations of order $2$}

Let $A(n)=c_1 A(n-1) + c_2 A(n-2)\ (*)$ and $t^2=c_1t +c_2\ (**)$. Suppose that $\lambda$ and $\mu$ are roots of $(**)$ where $\lambda \neq \mu$.
Then, 
\begin{align*}
1, \lambda, \lambda^2, \lambda^3, \cdots \\
1, \mu, \mu^2, \mu^3, \cdots
\end{align*}
are solutions of equation $(*)$. Since the solutions of a recurrence relation form a vector space 
$$
a_n=C \cdot \lambda^n + D \cdot \mu^n 
$$
is also a solution (the linear combinations of the above solutions).\\\\
\textbf{Question:} Are there any other solutions? 
\newpage
Well, the answer is "No", because for any solution $(a_0, a_1, \cdots)$ of $(*)$, there exist $C$
 and $D$ such that $a_n=C \dot \lambda^n + D \cdot \mu^n$ which is called the \textit{general solution} of $(*)$. But why is that so?
Since $(*)$ is a linear recurrence relation of order $k=2$, $(a_0, a_1, a_2, \cdots, a_n, \cdots)$ is uniquely determined by its first two terms $a_0$ and $a_1$.
We need to show that for any $a_0$ and $a_1$ there exist a $C$ and $D$ such that
\begin{align*}
&\begin{cases}
    a_0 = C + D\\    
    a_1 = C \dot \lambda + D \cdot \mu   
\end{cases}\\
&\begin{cases}
    D = a_0 - C\\    
    a_n = C \cdot \lambda + (a_0 - C) \cdot \mu   
\end{cases}\\
&
C=\frac{a_1 - a_0 \mu}{\lambda - \mu},\ D=\frac{a_0 \lambda - \mu}{\lambda - \mu} 
\end{align*}
\noindent
Therefore, $C$ and $D$ are uniquely determined, hence there are no other solutions then the above.

\subsection{The Binet formula}
In the following section we are going to go over two examples of the characteristic equation. 
\begin{exmp}
Let $A(n)=5 A(n-1)-6A(n-2)$. Find a solution for $a_0=3$ and $a_1=7$. First, define the characteristic which is quickly found.
\begin{align*}
t^2=5t-6\\
t^2-5t+6=0
\end{align*}
The roots are $\lambda=2$ and $\mu=3$, thus the general solution of our characteristic equation is given by
$$
a_n=C \cdot 2^n + D \cdot 3^n.
$$
Solving the equation for $C$ and $D$ yields the following system of linear equations.
\begin{align*}
    &\begin{cases}
        a_0 = 3 = C + D\\    
        a_1 = 7 = 2C + 3D   
    \end{cases}\\
    &\begin{cases}
        C=2\\
        D=1
    \end{cases}
\end{align*}
Therefore, 
$$
a_n=\underbrace{2^{n+1}}_{2 \cdot 2^n} + \underbrace{3^n}_{1 \cdot 3^n}.
$$
\end{exmp}
\newpage
\begin{exmp}
The Fibonacci sequence is given by the linear recurrence relation $F(n)=F(n-1)+F(n-2)$ with $f_0=0$ and $f_1=1$. Thus,
the characteristic equation is given by
\begin{align*}
t^2=t+1\\
t^2-t-1=0
\end{align*}
and the roots, call them $\varphi$ and $\psi$, follow
\begin{align*}
\varphi &= \frac{1 + \sqrt(5)}{2}\\
\psi &= \frac{1 - \sqrt(5)}{2}
\end{align*}
And as before
\begin{align*}
    &\begin{cases}
        0 = C + D\\    
        1 = C \cdot \varphi + D \cdot \psi   
    \end{cases}\\
    &\begin{cases}
        D = -C\\    
        1 = C (\varphi - \psi)   
    \end{cases}\\
    &\begin{cases}
        C = \frac{1}{\varphi - \psi}\\    
        D = \frac{1}{\psi - \varphi}   
    \end{cases}\\
    &\begin{cases}
        C = \frac{1}{\sqrt{5}}\\    
        D = -\frac{1}{\sqrt{5}}   
    \end{cases}\\
\end{align*}
The solution follows.
$$
f_n= \frac{\varphi^n - \psi^n}{\varphi - \psi} = \frac{1}{\sqrt{5}}\biggr (\biggr(\frac{1 + \sqrt{5}}{2}\biggl )^n - \biggr( \frac{1- \sqrt{5}}{2} \biggr )^n \biggr )
$$
This formula is called "The Binet Formula".
\end{exmp}

\subsection{Linear recurrence relations of arbitrary order}

It is no surprise that we can generalize the results of the last sections to linear recurrence relations of an arbitrary order $k$.
Given a linear recurrence relation
$$
A(n)=c_1A(n-1)+c_2A(n-2)+\cdots+c_kA(n-k)\ (*)
$$
then $1, \lambda, \lambda^2, \cdots, \lambda^n, \cdots$ is a solution of $(*)$ where $\lambda$ is a root of the characteristic equation
$$
t^k=c_1 t^{k-1} + \cdots + c_k.
$$
Suppose it has $k$ distinct roots $\lambda_1, \cdots, \lambda_k$, then 
$$
a_n=c_1 \lambda_1^n + c_2 \lambda_2^n + \cdots + c_k \lambda_k^n
$$
is the general solution. Suppose that we are given $a_0, \cdots, a_{k-1}$. We want a solution with the following initial solutions.
$$
\begin{cases}
    a_0 = c_1 + c_2 + \cdots + c_k\\    
    a_1 = c_1 \lambda_1 + c_2 \lambda_2 + \cdots + c_k \lambda_k\\
    \vdots \text{ } \cdots\\
    a_{k-1}= c_1 \lambda_1^{k-1} + c_2 \lambda_2^{k-2} + \cdots + c_k \lambda^{k-1}   
\end{cases}
$$
The above system of linear equations has a unique solution if and only if its determinant is equal to 
$$
\det\begin{pmatrix} 1 & 1 & \cdots & 1 
    \\ \lambda_1 & \lambda_2 & \cdots & \lambda_k \\
    \lambda_1^2 & \lambda_2^2 & \cdots & \lambda_k^2 \\
    \vdots & \vdots & \vdots & \vdots \\
    \lambda_1^{k-1} & \cdots & \cdots & \lambda_k^{k-1}  
\end{pmatrix} 
= \prod_{k \geq 1 > j \geq 1} (\lambda_i - \lambda_j)
$$
The above is known as the "Vandermont determinant" and since all $\lambda_i$ and $\lambda_j$ are distinct, the above has an unique solution.

\subsection{The case of roots with multiplicities}

What happens if some roots of the characteristic equation occur with multiplicities? Given $A(n)=c_1 A(n-1)+ c_2 A(n-2)$ yields $t^2-c_1t -c_2=0$.
Suppose that $\lambda$ is a unique (double) root of this equation, then
$$
\begin{cases}
    -c_2=\lambda^2\\    
    c_1 = 2 \lambda   
\end{cases}
$$
since $(t-\lambda)^2=t^2 -c_1t-c_2$ and $1, \lambda, \lambda^2, \cdots, \lambda^n$ is a solution.

\begin{claim}
$0, \lambda, 2 \lambda^2, 3 \lambda^3, \cdots, n \lambda^n$ is another solution.
\end{claim}
\begin{proof}
The above yields to
$$
n \lambda^n = c_1 (n-1)\lambda^{n-1} + c_2 (n-2)\lambda^{n-2}.
$$
The solution $-c_2=\lambda^2$ and $c_1=2 \lambda$ yields in the following.
$$
n \lambda^n = 2 \lambda(n-1)\lambda^{n-1} + (-\lambda^2)(n-2)\lambda^{n-2}
$$
Both sides are divisible by $\lambda^n$, thus $n=2(n-1)-(n-2)$ is a solution which is linearly independent of the previous one.
\end{proof}

In general, if $\lambda$ is a root of the characteristic polynomial of order $r$, then the characteristic polynomial is divisible by $(t- \lambda)^r$.
Hence, the following are all solutions of the above.
\begin{align*}
1, \lambda, \lambda^2, \cdots, \lambda^n, \cdots \\
0, \lambda, 2 \lambda^2, \cdots, n \lambda^n, \cdots \\
0, \lambda, 4 \lambda^4, 9 \lambda^3, \cdots, n^2 \lambda^n, \cdots \\
0, \lambda, 2^{r-1} \lambda^2, \cdots, n^{r-1}\lambda^n, \cdots
\end{align*}

\subsection{Exercises}

\begin{enumerate}
\item Which of the following is a Fibonacci sequence?
\begin{enumerate}
\item The number of partitions, i.e. the presentations of a natural number as a sum of positive non-increasing summands (i.e., $3=2+1=1+1+1$)
\item The number of sequences of $0$'s and $1$'1 with $n$ digits that contain no two consecutive zeroes
\item The number of subsets of $\{1,2, \cdots, n\}$ that contain no consecutive integers
\item The number of partitions of a rectangle $2 \times n$ into rectangles $2 \times 1$
\item The number of compositions of a natural number into positive odd summands (i.e., $4=1+1+1+1=1+3=3+1$)
\end{enumerate}
\item The Fibonacci sequence can be continues "backwards" using the same rule: $F_n=F_{n-1}+F_{n-2}$. For example, $F_0=0, F_{-1}=1$. Find $F_{-10}$.
\item Find the maximal common ration of a geometric progression $a_n$ satisfying the following equation: $a_{n+2}=3a_{n+1}-2a_n$.
\item The sequence $a_n$ is defined by the recurrence relation $a_{n+3}=3a_{n+2}-3a_{n+1}+a_n$ with initial values $a_0=a_1=0, a_2=1$. Find $a_{100}$.
\item The sequence $a_n$ is defined by the recurrence relation $a_{n+4}=a_{n+3}-a_{n+2}+a_{n+1}-a_n$ with initial values $a_0=1607, a_1=1707, a_2=1814, a_3=1914$. Find $a_{100}$.
\end{enumerate}