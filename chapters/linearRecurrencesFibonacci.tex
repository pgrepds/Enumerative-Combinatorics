\section[Linear recurrences]{Linear recurrences - The Fibonacci sequence}\label{fibonacci} 

We are going to discuss the Fibonacci sequence in the following section.

\subsection{Fibonacci's rabbit problem}

Suppose we have a pair of rabbits that are adults after one month. In the month after they are fully grown,
they give birth to two more rabbits. The newborns are again fully grown after one month and give birth to two more 
rabbits, and so on. Consider the following figure as an example.
\\
\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=1$\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=2 \text{ (grown up)}$
\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=3$
\\
$
\begin{array}{l}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
    \includegraphics[scale=0.1]{pictures/rabbits.jpg}
\end{array}
n=4$
\\
\\
\noindent
\textbf{Question:} How many pairs of rabbits will we have after one year?
\\
\\
\noindent
Let us introduce the following notation. Denote the number of pairs of rabbits during
the $n$-th month by $F(n)$. Then, we could express $F(n)$ by the number of rabbits in 
the $(n-1)$-th month and $(n-2)$-th month by the following equation.
$$
F(n)=F(n-1)+F(n-2)
$$
Thus, by setting $F(2)=1$ the following sequence of numbers follows.
$$
1,1,2,3,5,8,13,21,36,55,89,144, \cdots
$$
\noindent
The answer follows for $F(12)=144$, hence after $12$ months we have $144$ pairs of rabbits.
\\
\\
The above sequence is called the "Fibonacci sequence" and we are going to investigate some 
of its fascinating properties in the next sections.

\newpage

\subsection[Pascal triangle]{Fibonacci numbers and the Pascal triangle}

We consider once again the Pascal triangle. Let us sum up its diagonals. This is done in the following figure for 
the first few diagonals.
\\
\\
\begin{tabular}{>{$n=}l<{$\hspace{12pt}}*{13}{c}}
    0 &&&&&&&1&&&&&&\\
    1 &&&&&&1&&\color{red}1\textsuperscript{\color{red}=2}&&&&&\\
    2 &&&&&\color{red}1&&\color{yellow}2\textsuperscript{\color{yellow}=3}&&1&&&&\\
    3 &&&&\color{yellow}1&&\color{green}3\textsuperscript{\color{green}=4}&&\color{blue}3\textsuperscript{\color{blue}=8}&&\color{cyan}1\textsuperscript{\color{cyan}=13}&&&\\
    4 &&&\color{green}1&&\color{blue}4&&\color{cyan}6&&4&&1&&\\
    5 &&\color{blue}1&&\color{cyan}5&&10&&10&&5&&1&\\
    6 &\color{cyan}1&&6&&15&&20&&15&&6&&1
\end{tabular}
\\
\\
\noindent
The following sequence is the result.
$$
1,1,
\color{red} 1 \color{black}+ \color{red}1\color{black}=\color{red}2 \color{black}, \color{yellow} 1 \color{black}+ \color{yellow}2\color{black}=\color{yellow}3 \color{black}, 
\color{green} 1 \color{black}+ \color{green}3\color{black}=\color{green}4 \color{black}, 
\color{blue} 1 \color{black}+ \color{blue}4\color{black}+ \color{blue}3=\color{blue}8 \color{black}, 
\color{cyan} 1 \color{black}+ \color{cyan}5\color{black}+ \color{cyan}6\color{black}+ \color{cyan}1=\color{cyan}13 \color{black}, \cdots 
$$
The general formula for the sum of the diagonals in the Pascal triangle is easily derived. It is as follows.
$$
\sum_{k=0}^{\floor{\frac{n-1}{2}}} {n-k-1 \choose k}
$$

\subsection{Domino tilings}

\subsection{Linear recurrence relations}

In the following section, we are going to introduce the formal definition of a linear recurrence relation.

\begin{defn}
A linear recurrence relation of order $k$ is a sequence satisfying 
$$
A(n)=c_1A(n-1)+c_2A(n-2)+\cdots+c_kA(n-k)
$$
where $c_1,\cdots, c_k \in \mathbb{R}$.
\label{defn:rec}
\end{defn}

\begin{exmp}
The Fibonacci sequence $F(n)=F(n-1)+F(n-2)$ is a linear recurrence relation of order $2$. The sequence
$A(n)=A(n-1)+A(n-2)+A(n-5)$ from the last section is a linear recurrence relation of order $5$.
\end{exmp}

\begin{remark}
A sequence defined by a linear recurrence relation is uniquely determined by the first $k$ terms $A(0), A(1), \cdots, A(k-1)$.
Why is that the case? Suppose that $a_0, a_1, a_2, \cdots$ and $a_0', a_1', a_2', \cdots$ satisfy the relation of definition \ref{defn:rec},
then $a_0+a_0', a_1+a_1',a_2+a_2', \cdots$ also satisfy this relation and so does $c \cdots a_0, c \cdot a_1, c \cdot a_2, \cdots$.
In other words, the solutions of a linear recurrence relation form a vector space.
\end{remark}

\subsection[The characteristic equation]{The characteristic equation}

\subsection{Linear recurrence relations of order $2$}

\subsection{The Binet formula}

\subsection{Linear recurrence relations of arbitrary order}

\subsection{The case of roots with multiplicities}

\subsection{Exercises}

\begin{enumerate}
\item Which of the following is a Fibonacci sequence?
\begin{enumerate}
\item The number of partitions, i.e. the presentations of a natural number as a sum of positive non-increasing summands (i.e., $3=2+1=1+1+1$)
\item The number of sequences of $0$'s and $1$'1 with $n$ digits that contain no two consecutive zeroes
\item The number of subsets of $\{1,2, \cdots, n\}$ that contain no consecutive integers
\item The number of partitions of a rectangle $2 \times n$ into rectangles $2 \times 1$
\item The number of compositions of a natural number into positive odd summands (i.e., $4=1+1+1+1=1+3=3+1$)
\end{enumerate}
\item The Fibonacci sequence can be continues "backwards" using the same rule: $F_n=F_{n-1}+F_{n-2}$. For example, $F_0=0, F_{-1}=1$. Find $F_{-10}$.
\item Find the maximal common ration of a geometric progression $a_n$ satisfying the following equation: $a_{n+2}=3a_{n+1}-2a_n$.
\item The sequence $a_n$ is defined by the recurrence relation $a_{n+3}=3a_{n+2}-3a_{n+1}+a_n$ with initial values $a_0=a_1=0, a_2=1$. Find $a_{100}$.
\item The sequence $a_n$ is defined by the recurrence relation $a_{n+4}=a_{n+3}-a_{n+2}+a_{n+1}-a_n$ with initial values $a_0=1607, a_1=1707, a_2=1814, a_3=1914$. Find $a_{100}$.
\end{enumerate}